<groot-table-title-bar
  [searchResults]="data"
  [downloadExcelLabel]="downloadExcelLabel"
  [downloadExcelUrl]="downloadExcelUrl"
  [downloadExcelUrlProvider]="downloadExcelUrlProvider"
  [downloadExcelArgsProvider]="downloadExcelArgs"
  [downloadExcelIsAjax]="downloadExcelIsAjax"
  [downloadExcelFileName]="downloadExcelFileName"
  [showRefreshIcon]="showRefreshIcon"
  [lastRefreshTimestamp]="lastRefreshTimestamp"
  (refresh)="reloadTable(infiniteScroll)"
  [label]="titleLabel"
  *ngIf="!hideTitleBar"
>
  <ng-container *ngTemplateOutlet="tableTitleRightArea"></ng-container>
</groot-table-title-bar>

<ag-grid-angular
  #grid
  style="width: 100%;"
  [style.height]="gridHeightCss"
  [class]="defaultClass"
  [gridOptions]="gridOptions"
  (sortChanged)="onSortChanged()"
  (gridReady)="gridReady($event)"
  (firstDataRendered)="firstDataRendered()"
  noRowsOverlayComponent="GrootAgGridNoRowsOverlayComponent"
  [noRowsOverlayComponentParams]="noRowsOverlayComponentParams"
  loadingOverlayComponent="GrootAgGridLoadingOverlayComponent"
  (dragStopped)="saveColumnOrder()"
  (cellClicked)="cellClicked.emit($event)"
  (cellMouseDown)="cellMouseDown($event)"
  [rowSelection]="(checkboxSelection || rowMultiSelectWithClick) ? 'multiple' : (singleRowSelection ? 'single' : undefined)"
  [rowMultiSelectWithClick]="checkboxSelection || rowMultiSelectWithClick"
  [suppressRowClickSelection]="checkboxSelection"
  [suppressRowTransform]="suppressRowTransform"
  [suppressDragLeaveHidesColumns]="true"
  (bodyScroll)="onScroll($event)"
  (selectionChanged)="gridSelectionChanged()"
  [alignedGrids]="alignedGridsComponents"
  (gridSizeChanged)="autoSizeColumns()"
  [modules]="modules"
  [autoGroupColumnDef]="autoGroupColumnDef"
  [groupDisplayType]="groupDisplayType"
  [suppressAggFuncInHeader]="suppressAggFuncInHeader"
  [getRowId]="getRowId"
  (rowDragEnter)="onRowDragEnter($event)"
  (rowDragEnd)="onRowDragEnd($event)"
  (rowDragMove)="onRowDragMove($event)"
  (rowDragLeave)="onRowDragLeave($event)"
></ag-grid-angular>


<groot-table-pagination
  #gridPagination
  *ngIf="!(infiniteScroll || disablePagination) && data && (showPaginationIfEmpty || (data.totalNumRecords > 0 && data.totalNumRecords > data.pageLen) || data.totalNumRecords === -1)"
  [class.groot-paginator-hidden]="data.totalNumRecords !== -1 && (data.totalNumRecords <= 0 || data.totalNumRecords <= data.pageLen)"
  [totalItems]="data.totalNumRecords"
  [pageSize]="pageSize"
  (pageNumChange)="onPageChanged($event)"
  [loadedPageNum]="data.pageNum"
></groot-table-pagination>


<ng-template #accordionButtonTemplate let-row let-index="index">
  <div (click)="toggleAccordion(row, index)"
       *ngIf="row && !row.$isAccordionRow"
       class="accordion-icon">
    <i class="fa-solid fa-chevron-down" *ngIf="!row.$showingAccordion" aria-hidden="true"></i>
    <i class="fa-solid fa-chevron-up" *ngIf="row.$showingAccordion" aria-hidden="true"></i>
  </div>
</ng-template>
